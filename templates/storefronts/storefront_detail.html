{% extends "base.html" %}

{% block content %}

  {# Page-specific: remove the extra “card/container layer” coming from base layout #}
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const main = document.querySelector("main.page-container");
      if (!main) return;

      // Flatten the base container for this page only (no CSS edits needed)
      main.style.padding = "0";
      main.style.background = "transparent";
      main.style.boxShadow = "none";
      main.style.borderRadius = "0";
      main.style.maxWidth = "none";
      main.style.margin = "0";
    });
  </script>

  {# Keep the surface div (required by layout positioning) but remove the “extra layer” feel #}
  <div id="sf-public-surface"
       style="position: relative; width: 100%; min-height: 650px; margin: 0; padding: 0; background: transparent;">
    {# The real storefront content that will be positioned by the public script #}

    {% if storefront.logo %}
      <div data-sf-block="logo" data-sf-label="LOGO">
        <div class="storefront-public-logo">
          <img src="{{ storefront.logo.url }}" alt="{{ storefront.headline|default:'Storefront logo' }}">
        </div>
      </div>
    {% endif %}

    <div data-sf-block="headline" data-sf-label="HEADLINE">
      <h1 class="page-title text-center">
        {{ storefront.headline|default:"Your storefront headline" }}
      </h1>
    </div>

    {% if storefront.description %}
      <div data-sf-block="description" data-sf-label="DESCRIPTION">
        <p class="lead text-center storefront-public-description">
          {{ storefront.description }}
        </p>
      </div>
    {% endif %}

    {% if storefront.contact_details %}
      <div data-sf-block="contact_title" data-sf-label="CONTACT TITLE">
        <h2 class="storefront-section-heading">Contact details</h2>
      </div>

      <div data-sf-block="contact_text" data-sf-label="CONTACT TEXT">
        <p>{{ storefront.contact_details|linebreaksbr }}</p>
      </div>
    {% endif %}

    {% if cards %}
      <div data-sf-block="cards_title" data-sf-label="FEATURED CARDS TITLE">
        <h2 class="storefront-section-heading">Featured digital cards</h2>
      </div>

      <div data-sf-block="cards_grid" data-sf-label="CARDS GRID">
        <div class="storefront-cards-grid">
          {% for card in cards %}
            <div class="storefront-card">
              {% if card.image_url %}
                <img src="{{ card.image_url }}" alt="{{ card.title }}" class="storefront-card-img">
              {% endif %}
              <div class="storefront-card-body">
                <h3 class="storefront-card-title">{{ card.title }}</h3>
                {% if card.price_label %}
                  <p class="storefront-card-price">{{ card.price_label }}</p>
                {% endif %}
                {% if card.description %}
                  <p class="storefront-card-desc">{{ card.description }}</p>
                {% endif %}
                {% if card.buy_url %}
                  <a class="btn btn-primary" href="{{ card.buy_url }}" target="_blank" rel="noopener">
                    Buy now
                  </a>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endif %}

  </div>

  {# Layout JSON for the public-page script (NO default filter here -> fixes the error) #}
  <script id="sf-layout-data" type="application/json">
    {{ layout|json_script:"sf-layout-data" }}
  </script>

  <script id="sf-style-data" type="application/json">
    {{ styles|json_script:"sf-style-data" }}
  </script>

  <script id="sf-bg-data" type="application/json">
    {{ bg|json_script:"sf-bg-data" }}
  </script>

{% endblock %}
